<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Page Title</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="styles/reset.css">
  <link rel="stylesheet" href="styles/base.css">
  <link rel="stylesheet" href="styles/layout.css">
  <link rel="stylesheet" href="styles/modules.css">
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
  
  <script type="text/x-handlebars-template" id="about-us-template">

    <div class="template">
      <img src="{{image_url}}" alt="{{name}} Image" title="{{name}} Image" />
      <h2>{{name}}</h2>
      <p>{{bio}}</p>
      <p class=profileLinks><a href="{{linkedin_url}}">Linked-In</a> | <a href="{{github_url}}">GitHub</a> | <a href="mailto:{{email}}">Email</a></p>
    </div>
  </script>
</head>
<body>
  <header>
    <div><h1 id="logo"><a href=""> <strong>Play&Rest</strong></a></h1></div>
    <div>
      <nav>
        <ul>
          <li id="home"><a href="">HOME</a></li>
          <li id="about-nav"><a href="">ABOUT US</a></li>
        </ul>
      </nav>
    </div>
  </header>
   

  <main>

    <section  class="content"></section>

    <img id="hero-image" class="content" src="img/pic1.jpeg" alt="Hero image" >

    <section id="greetingPage" class="content"></section>
      
      <section id="activities" class="content">
        
        
        <label for="filter-boxes">Check the boxes to filter</label>
        
      <input type="checkbox" id="playBox" name="play" checked="checked">
      <label for="play">Play Areas</label>
      
      <input type="checkbox" id="dogsBox" name="dogs" checked="checked">
      <label for="dogs">Dog  Off-leash Areas</label>
      
      <input type="checkbox" id="waterBox" name="water" checked="checked">
      <label for="water">Waterfront Areas</label>
      
      <button id="submit"type="submit-location">Filter Locations</button>

    </section>

    <input id="autocomplete" class="controls" type="text" placeholder="search a location">  
    
    <section class="content">
      <div id="legend"><h3>Legend</h3></div>

      <div id="map-canvas"></div>
      <div id="map"></div>

    </section>

    <section id="aboutUsPage" class="content"> </section>
    
  </main>
  <footer>
    <div>&copy; Copyright 2018</div>
  </footer>
  

  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script src="https://cdn.rawgit.com/visionmedia/page.js/master/page.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>
  <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script>
  
  <script src="./scripts/models/page.js" type="text/javascript"></script>
  <script src="./scripts/views/greetingPage.js" type="text/javascript"></script>
  <script src="./scripts/views/aboutUs.js" type="text/javascript"></script>
  <script src="./scripts/views/mainPage.js" type="text/javascript"></script>
  <script src="./scripts/views/mapView.js" type="text/javascript"></script>
  
  
  <!-- <script src="./scripts/views/error-view.js" type="text/javascript"></script>
    <script src="./scripts/views/admin-view.js" type="text/javascript"></script> -->
    
    <script src="./scripts/views/routes.js" type="text/javascript"></script>
    <script>
      var autocomplete;
      
      // LEGEND
    
      var icons = {
          play: {
            name: 'Play Areas',
            icon: 'img/childIcon.png'
          },
          dogs: {
            name: 'Dog Off-Leash Areas',
            icon: 'img/dogIcon.png'
          },
          water: {
            name: 'Waterfront Areas',
            icon: 'img/waterIcon.png'
          }
        };
    
      var legend = document.getElementById('legend');
    
      for (var key in icons) {
        var type = icons[key];
        var name = type.name;
        var icon = type.icon;
        var div = document.createElement('div');
        div.innerHTML = '<img src="' + icon + '"> ' + name;
        legend.appendChild(div);
      }
    
    function initMap() {

      // event.preventDefault();
      
      // INIT MAP

      var seattle = {lat: 47.6062, lng: -122.3321};
      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 11,
        center: seattle
      });

      // AUTOCOMPLETE

      autocomplete = new google.maps.places.Autocomplete(
        (document.getElementById('autocomplete')), {
        });

        autocomplete.addListener('place_changed', onPlaceChanged);

      // PLAY AREAS CODE

       if ($('#playBox').prop("checked")){ 

      app.Place.fetchPlay(initPlayHelper);

      }

      function initPlayHelper(){
            
        let image = 'img/childIcon.png';

        for (let i=0; i<app.playArr.length;i++) {
      
        let newPlace = {lat: parseFloat(app.playArr[i].latitude), lng: parseFloat(app.playArr[i].longitude)};
        
        let playMarker = new google.maps.Marker({
          position: newPlace,
          map: map,   
          icon: image
        }); 

        let contentString = '<div class="popUp">'+
            '<h1>' + app.playArr[i].name + '</h1>'+
            '<p>' + app.playArr[i].address + '</p>'+
            '<p>' + app.playArr[i].website + '</p>' +
            '</div>';

        let infowindow = new google.maps.InfoWindow({
          content: contentString,
        });

        playMarker.addListener('click', function() {
        infowindow.open(map, playMarker);
        });
      
        }
      }
    
    // DOG AREAS CODE

 if ($('#dogsBox').prop("checked")){ 

    app.Place.fetchDog(initDogHelper);
 
  }

function initDogHelper(){
      
  let image = 'img/dogIcon.png';

  for (let i=0; i<app.dogArr.length;i++) {

  let newPlace = {lat: parseFloat(app.dogArr[i].latitude), lng: parseFloat(app.dogArr[i].longitude)};
  
  let dogMarker = new google.maps.Marker({
    position: newPlace,
    map: map,   
    icon: image
  }); 

  let contentString = '<div class="popUp">'+
      '<h1>' + app.dogArr[i].name + '</h1>'+
      '<p>' + app.dogArr[i].address + '</p>'+
      '<p>' + app.dogArr[i].website + '</p>' +
      '</div>';

  let infowindow = new google.maps.InfoWindow({
    content: contentString
  });

  dogMarker.addListener('click', function() {
  infowindow.open(map, dogMarker);
  });

  }
}

    // WATER AREAS CODE

     if ($('#waterBox').prop("checked")){ 
    app.Place.fetchWater(initWaterHelper);
  }

function initWaterHelper(){
      
  let image = 'img/waterIcon.png';

  for (let i=0; i<app.waterArr.length;i++) {

  let newPlace = {lat: parseFloat(app.waterArr[i].latitude), lng: parseFloat(app.waterArr[i].longitude)};
  
  let waterMarker = new google.maps.Marker({
    position: newPlace,
    map: map,   

    icon: image
  }); 

  let contentString ='<div class="popUp">'+
      '<h1>' + app.waterArr[i].name + '</h1>'+
      '<p>' + app.waterArr[i].address + '</p>'+
      '<p>' + app.waterArr[i].website + '</p>' +
      '</div>'

  let infowindow = new google.maps.InfoWindow({
    content: contentString
  });

  waterMarker.addListener('click', function() {
  infowindow.open(map, waterMarker);
  });

  }
}
      function onPlaceChanged() {
        var place = autocomplete.getPlace();
        if (place.geometry) {
          map.panTo(place.geometry.location);
          map.setZoom(15);
        } else {
          document.getElementById('autocomplete').placeholder = 'search locations';
        }
      }
    }

  $('#submit').on('click', initMap)

      </script>
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDpfL336O08zBiCPdcVijYcL6APg0_0UJY&libraries=places&callback=initMap"
      type="text/javascript">
    </script>
  
</body>
</html>